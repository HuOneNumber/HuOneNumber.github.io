<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="keywords" content="HTML,CSS,JavaScript">
    <meta name="description" content="Hexo Theme Keep">
    <meta name="author" content="胡倚豪">
    
    <title>
        
            02-应用层 |
        
        HuOneNumber | 个人博客
    </title>
    
<link rel="stylesheet" href="/css/style.css">

    <link rel="shortcut icon" href="/images/avatar.png">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.3/source/css/font-awesome.min.css">
    <script id="hexo-configurations">
    let KEEP = window.KEEP || {};
    KEEP.hexo_config = {"hostname":"example.com","root":"/","language":"zh-CN","path":"search.xml"};
    KEEP.theme_config = {"toc":{"enable":true,"number":false,"expand_all":true,"init_open":true},"style":{"primary_color":"#33FFCC","avatar":"/images/avatar.png","favicon":"/images/avatar.png","article_img_align":"left","left_side_width":"260px","content_max_width":"920px","hover":{"shadow":true,"scale":true},"first_screen":{"enable":true,"description":"慢慢来，深几度。。。","background_img":"/images/bg.svg"},"scroll":{"progress_bar":{"enable":true},"percent":{"enable":true}}},"local_search":{"enable":true,"trigger":"auto","unescape":false,"preload":true},"code_copy":{"enable":true,"style":"mac"},"pjax":{"enable":true},"lazyload":{"enable":true},"version":"3.4.3"};
    KEEP.language_ago = {"second":"%s 秒前","minute":"%s 分钟前","hour":"%s 小时前","day":"%s 天前","week":"%s 周前","month":"%s 月前","year":"%s 年前"};
  </script>
<meta name="generator" content="Hexo 5.3.0"><link rel="alternate" href="/atom.xml" title="别着急，慢慢来" type="application/atom+xml">
</head>


<body>
<div class="progress-bar-container">
    
        <span class="scroll-progress-bar"></span>
    

    
        <span class="pjax-progress-bar"></span>
        <span class="pjax-progress-icon">
            <i class="fas fa-circle-notch fa-spin"></i>
        </span>
    
</div>


<main class="page-container">

    

    <div class="page-main-content">

        <div class="page-main-content-top">
            <header class="header-wrapper">

    <div class="header-content">
        <div class="left">
            
            <a class="logo-title" href="/">
                HuOneNumber | 个人博客
            </a>
        </div>

        <div class="right">
            <div class="pc">
                <ul class="menu-list">
                    
                        <li class="menu-item">
                            <a class=""
                               href="/"
                            >
                                首页
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/archives"
                            >
                                归档
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/categories"
                            >
                                分类
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/tags"
                            >
                                标签
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/about"
                            >
                                关于
                            </a>
                        </li>
                    
                    
                        <li class="menu-item search search-popup-trigger">
                            <i class="fas fa-search"></i>
                        </li>
                    
                </ul>
            </div>
            <div class="mobile">
                
                    <div class="icon-item search search-popup-trigger"><i class="fas fa-search"></i></div>
                
                <div class="icon-item menu-bar">
                    <div class="menu-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="header-drawer">
        <ul class="drawer-menu-list">
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/">首页</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/archives">归档</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/categories">分类</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/tags">标签</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/about">关于</a>
                </li>
            
        </ul>
    </div>

    <div class="window-mask"></div>

</header>


        </div>

        <div class="page-main-content-middle">

            <div class="main-content">

                
                    <div class="fade-in-down-animation">
    <div class="article-content-container">

        <div class="article-title">
            <span class="title-hover-animation">02-应用层</span>
        </div>

        
            <div class="article-header">
                <div class="avatar">
                    <img src="/images/avatar.png">
                </div>
                <div class="info">
                    <div class="author">
                        <span class="name">胡倚豪</span>
                        
                            <span class="author-label">Lv4</span>
                        
                    </div>
                    <div class="meta-info">
                        <div class="article-meta-info">
    <span class="article-date article-meta-item">
        <i class="fas fa-edit"></i>&nbsp;2021-05-10 10:36:52
    </span>
    
        <span class="article-categories article-meta-item">
            <i class="fas fa-folder"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">学习笔记</a>&nbsp;
                    </li>
                
                    <li>
                        &gt; <a href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%EF%BC%9A%E8%87%AA%E9%A1%B6%E5%90%91%E4%B8%8B%E6%96%B9%E6%B3%95/">计算机网络：自顶向下方法</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    
    
        <span class="article-tags article-meta-item">
            <i class="fas fa-tags"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/tags/Computer-Network/">Computer Network</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    

    
    
        <span class="article-wordcount article-meta-item">
            <i class="fas fa-file-word"></i>&nbsp;<span>5.5k 字</span>
        </span>
    
    
        <span class="article-min2read article-meta-item">
            <i class="fas fa-clock"></i>&nbsp;<span>19 分钟</span>
        </span>
    
    
        <span class="article-pv article-meta-item">
            <i class="fas fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span>
        </span>
    
</div>

                    </div>
                </div>
            </div>
        

        <div class="article-content markdown-body">
            <h2 id="2-1-应用层协议原理"><a href="#2-1-应用层协议原理" class="headerlink" title="2.1   应用层协议原理"></a>2.1   应用层协议原理</h2><h3 id="2-1-1-网络应用程序体系结构"><a href="#2-1-1-网络应用程序体系结构" class="headerlink" title="2.1.1   网络应用程序体系结构"></a>2.1.1   网络应用程序体系结构</h3><p>网络体系结构是固定的，并为应用程序提供了特定的服务集，应用程序体系结构由研发者设计，规定了如何在各种端系统上组织该应用程序。两种主流体系结构之一：客户-服务器体系结构或对等（P2P）体系结构。</p>
<p>客户一服务器体系结构（client-server architecture）中，有一个总是打开的主机称为服务器，它服务于来自许多其他称为客户的主机的请求。例如Web应用。</p>
<p>在P2P体系结构中，对位于数据中心的专用服务器有最小甚至没有的依赖。相反，应用程序在间断连接的主机对之间使用直接通信，这些主机对被称为对等方。例如文件共享、迅雷、电话和视频会议。某些应用具有混合的体系结构。例如，对于许多即时讯息应用而言，服务器被用于跟踪用户的IP地址，但可在用户主机之间（无须通过中间服务器）直接发送报文。</p>
<h3 id="2-1-2-进程通信"><a href="#2-1-2-进程通信" class="headerlink" title="2.1.2   进程通信"></a>2.1.2   进程通信</h3><p>进行通信的实际上是进程而不是程序。一个进程可以被认为是运行在端系统中的一个程序。进程间通信的规则由端系统上的操作系统确定。在两个不同端系统上的进程，通过跨越计算机网络交换报文（message）而相互通信。</p>
<h4 id="2-1-2-1-客户和服务器进程"><a href="#2-1-2-1-客户和服务器进程" class="headerlink" title="2.1.2.1   客户和服务器进程"></a>2.1.2.1   客户和服务器进程</h4><p>网络应用程序由成对的进程组成，这些进程通过网络相互发送报文。。我们定义客户和服务器进程如下：发起通信的进程被标识为客户，在会话开始时等待联系的进程是服务器。</p>
<p>在Web中，一个浏览器进程向一台Web服务器进程发起联系，因此该浏览器进程是客户，而该Web服务器进程是服务器。在P2P文件共享中，当对等方A请求对等方B发送一个特定的文件时，在这个特定的通信会话中对等方A是客户，而对等方B是服务器。在P2P文件共享的某些应用中，一个进程能够既是客户又是服务器。</p>
<h4 id="2-1-2-2-进程与计算机网络之间的接口"><a href="#2-1-2-2-进程与计算机网络之间的接口" class="headerlink" title="2.1.2.2   进程与计算机网络之间的接口"></a>2.1.2.2   进程与计算机网络之间的接口</h4><p>进程通过套接字接口向网络发送和接收报文。套接字是同一台主机内应用层与运输层之间的接口。应用程序开发者可以控制套接字在应用层端的一切，但是对该套接字的运输层端几乎没有控制权。应用程序开发者对于运输层的控制仅限于：1. 选择运输层协议；2. 设定几个运输层参数，如最大缓存和最大报文段长度等。一旦应用程序开发者选择了一个运输层协议（如果可供选择），则应用程序就建立在由该协议提供的运输层服务之上。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://i.loli.net/2021/05/13/OgkYyHpXEqRes5W.png"
                      alt="image-20210513112006886"
                ></p>
<h4 id="2-1-2-3-进程寻址"><a href="#2-1-2-3-进程寻址" class="headerlink" title="2.1.2.3   进程寻址"></a>2.1.2.3   进程寻址</h4><p>如果一台主机上运行的进程向在另一台主机上运行的进程发送分组，为了标识该接收进程，需要定义主机的IP地址，以及在目的主机的端口号（指定运行在接收主机上的接收进程，也就是接收套接字）。</p>
<h3 id="2-1-3-可供应用程序使用的运输服务"><a href="#2-1-3-可供应用程序使用的运输服务" class="headerlink" title="2.1.3   可供应用程序使用的运输服务"></a>2.1.3   可供应用程序使用的运输服务</h3><p>从四个方面对应用程序服务要求进行分类：可靠数据传输、吞吐量、定时和安全性。</p>
<ol>
<li>可靠数据传输<br>由于分组在计算机网络中可能丢失，因此需要运输层协议能够潜在地向应用程序提供的一个重要服务是进程到进程的可靠数据传输。</li>
<li>吞吐量<br>因为其他会话将共享沿着该网络路径的带宽，并且因为这些会话将会到达和离开，该可用吞吐量将随时间波动。因此运输层协议应该能够以某种特定的速率提供确保的可用吞吐量。</li>
<li>定时<br>运输层协议也能提供定时保证。为了有效性而要求数据交付有严格的时间限制。</li>
<li>安全性<br>运输协议能够为应用程序提供一种或多种安全性服务，包括加密、数据完整性和端点鉴别。</li>
</ol>
<h3 id="2-1-4-因特网提供的运输服务"><a href="#2-1-4-因特网提供的运输服务" class="headerlink" title="2.1.4   因特网提供的运输服务"></a>2.1.4   因特网提供的运输服务</h3><p>因特网为应用程序提供两个运输层协议，即UDP和TCP，每个协议为调用它们的应用程序提供了不同的服务集合。</p>
<h4 id="2-1-4-1-TCP-服务"><a href="#2-1-4-1-TCP-服务" class="headerlink" title="2.1.4.1   TCP 服务"></a>2.1.4.1   TCP 服务</h4><p>TCP服务模型包括<strong>面向连接服务</strong>和<strong>可靠数据传输服务</strong>。</p>
<p>面向连接的服务：在应用层数据报文开始流动之前，TCP让客户和服务器互相交换运输层控制信息，提醒客户和服务器为大量分组的到来做好准备。在握手阶段后，在两个进程的套接字之间就建立了一个TCP连接，这条连接是全双工的，即连接双方的进程可以在此连接上同时进行报文收发。当应用程序结束报文发送时，必须拆除该连接。</p>
<p>可靠的数据传送服务：通信进程能够依靠TCP无差错、按适当顺序交付所有发送的数据。<br>TCP协议还具有拥塞控制机制，这种服务或许不能为单个通信进程带来好处，但能为因特网带来整体好处。当发送方和接收方之间的网络出现拥塞时，TCP的拥塞控制机制会抑制发送进程（客户或服务器）。</p>
<h4 id="2-1-4-2-UDP服务"><a href="#2-1-4-2-UDP服务" class="headerlink" title="2.1.4.2   UDP服务"></a>2.1.4.2   UDP服务</h4><p>UDP是一种不提供不必要服务的轻量级运输协议，它仅提供最小服务。UDP是无连接的，因此在两个进程通信前没有握手过程。UDP协议提供一种不可靠数据传送服务，不仅如此，到达接收进程的报文也可能是乱序到达的。<br>UDP没有包括拥塞控制机制，所以UDP的发送端可以用它选定的任何速率向其下层（网络层）注入数据。</p>
<h4 id="2-1-4-3-TCP安全"><a href="#2-1-4-3-TCP安全" class="headerlink" title="2.1.4.3  TCP安全"></a>2.1.4.3  TCP安全</h4><p>无论TCP还是UDP都没有提供任何加密机制，所以研制了TCP的加强版本，称为安全套接字（<strong>SSL</strong>），提供了关键的进程到进程的安全性服务，包括加密、数据完整性和端点鉴别。</p>
<p>SSL不是第三种因特网运输协议，而是一种对TCP的加强，这种强化是在应用层上实现的。如果一个应用程序要使用SSL的服务，它需要在该应用程序的客户端和服务器端包含SSL代码。SSL有自己的套接字API，发送进程向SSL套接字传递明文数据；SSL则加密该数据并将加密的数据传递给TCP套接字。加密的数据经因特网传送到接收进程中的TCP套接字，该接收套接字将加密数据传递给SSL，由其进行解密，最后，SSL通过它的SSL套接字将明文数据传递给接收进程。</p>
<h3 id="2-1-5-应用层协议"><a href="#2-1-5-应用层协议" class="headerlink" title="2.1.5   应用层协议"></a>2.1.5   应用层协议</h3><p>应用层协议定义了运行在不同端系统上的应用程序进程如何相互传递报文。特别是应用层协议定义了：1. 交换的报文类型，如请求报文和响应报文；2. 各种报文类型的语法，如报文中的各个字段及这些字段是如何描述的；3. 字段的语义，即这些字段中的信息的含义；4. 确定一个进程何时以及如何发送报文，对报文进行响应的规则。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://i.loli.net/2021/05/13/SldDW6VtFnbkXEi.png"
                      alt="image-20210513203552242"
                ></p>
<h2 id="2-2-Web和HTTP"><a href="#2-2-Web和HTTP" class="headerlink" title="2.2   Web和HTTP"></a>2.2   Web和HTTP</h2><p>20世纪90年代以前，因特网的主要使用者还是研究人员、学者和大学生，他们登录远程主机，在本地主机和远程主机之间传输文件，收发新闻，收发电子邮件。尽管这些应用非常有用（并且继续如此），但是因特网基本上不为学术界和研究界之外所知。<br>到了20世纪90年代初期，一个主要的新型应用即万维网（World Wide Web）登上了舞台<br>[Berners-Lee 1994.，Web是一个引起公众注意的因特网应用，它极大地改变了人们与工作环境内外交流的方式。它将因特网从只是很多数据网之一的地位提升为仅有的一个数据网。<br>也许对大多数用户来说，最具有吸引力的就是Web的按需操作。当用户需要时，就能得到所想要的内容。这不同于无线电广播和电视，它们迫使用户只能收听、收看内容提供者提供的节目。除了可以按需操作以外，Web还有很多让人们喜欢和珍爱的特性。任何人使信息在Web上可用都非常简单，即只需要极低的费用就能成为出版人。超链接和搜索引擎帮助我们在Web站点的海洋里导航。图片和视频刺激着我们的感官。表单、Javascript，Java小程序和很多其他的装置，使我们可以与Web页面和站点进行交互。并且，Web及其协议作为平台，为YouTube、基于Web的电子邮件（如Gmail）和大多数移动因特网应用（包括Instagram和谷歌地图）服务。</p>
<h3 id="2-2-1-HTTP概况"><a href="#2-2-1-HTTP概况" class="headerlink" title="2.2.1   HTTP概况"></a>2.2.1   HTTP概况</h3><p>Web的应用层协议是超文本传输协议（HTTP）。HTTP由两个程序实现：一个客户程序和一个服务器程序，通过交换HTTP报文进行会话。</p>
<p>HTTP使用TCP作为它的支撑运输协议，HTTP客户首先发起一个与服务器的TCP连接。一旦连接建立，该浏览器和服务器进程就可以通过套接字接口访问ТСР。客户向它的套接字接口发送HTTP请求报文并从它的套接字接口接收HTTP响应报文。一旦客户向它的套接字接口发送了一个请求报文，该报文就脱离了客户控制并进入TCP的控制。</p>
<p>服务器向客户发送被请求的文件，而不存储任何关于该客户的状态信息。假如某个特定的客户在短短的几秒内两次请求同一个对象，服务器会重新发送该对象，所以我们说HTTP是一个无状态协议。</p>
<h3 id="2-2-2-非持续连接和持续连接"><a href="#2-2-2-非持续连接和持续连接" class="headerlink" title="2.2.2   非持续连接和持续连接"></a>2.2.2   非持续连接和持续连接</h3><p>非持续连接：每个请求/响应对是经一个单独的TCP连接发送，用户能够配置浏览器来控制连接的并行度。在默认方式下，大部分浏览器打开5~10个并行的TCP连接，每条连接只处理一个请求响应事务。</p>
<p>往返时间（RTT），该时间是指一个短分组从客户到服务器然后再返回客户所花费的时间。RTT包括分组传播时延、分组在中间路由器和交换机上的排队时延以及分组处理时延。</p>
<p>浏览器在它和Web服务器之间发起一个TCP连接：这涉及一次“三次握手”过程，即客户向服务器发送一个小TCP报文段，服务器用一个小TCP报文段做出确认和响应，最后客户向服务器返回确认。三次握手中前两个部分占用了一个RTT，完成了三次握手的前两个部分后，客户结合三次握手的第三部分（确认）向该TCP连接发送一个HTTP请求报文。一旦该请求报文到达服务器，服务器就在该TCP连接上发送HTML文件。该HTTP请求/响应用去了另一个RTT。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://i.loli.net/2021/05/13/XjhdIJ1s74gtaoG.png"
                      alt="image-20210513213831777"
                ></p>
<p>缺点：第一，必须为每一个请求的对象建立和维护一个新的连接，在客户和服务器中都要分配每个TCP的缓冲区和保持TCP变量。第二，每一个对象经受两倍RTT的交付时延，即一个RTT用于创建TCP，另一个RTT用于请求和接收一个对象。</p>
<p>持续连接：所有的请求及其响应经相同的TCP连接发送呢。HTTP在其默认方式下使用持续连接。</p>
<h3 id="2-2-3-HTTP报文格式"><a href="#2-2-3-HTTP报文格式" class="headerlink" title="2.2.3   HTTP报文格式"></a>2.2.3   HTTP报文格式</h3><p>参照《HTTP权威指南》。</p>
<h3 id="2-2-4-用户与服务器的交互：cookie"><a href="#2-2-4-用户与服务器的交互：cookie" class="headerlink" title="2.2.4   用户与服务器的交互：cookie"></a>2.2.4   用户与服务器的交互：cookie</h3><p>cookie，允许站点对用户进行跟踪，用于标识一个用户。用户首次访问一个站点时，可能需要提供一个用户标识。在后继会话中，浏览器向服务器传递一个cookie首部，从而向该服务器标识了用户。因此cookie可以在无状态的HTTP之上建立一个用户会话层。cookie技术有4个组件：</p>
<ol>
<li>在HTTP响应报文中的一个cookie首部行；</li>
<li>在HTTP请求报文中的一个cookie首部行；</li>
<li>在用户端系统中保留有一个cookie文件，并由用户的浏览器进行管理；</li>
<li>位于Web站点的一个后端数据库。</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://i.loli.net/2021/05/13/J296joUDX5hSVfn.png"
                      alt="image-20210513214554431"
                ></p>
<h3 id="2-2-5-Web缓存"><a href="#2-2-5-Web缓存" class="headerlink" title="2.2.5   Web缓存"></a>2.2.5   Web缓存</h3><p>Web缓存器也叫代理服务器，Web缓存器在存储空间中保存最近请求过的对象的副本。可以配置用户的浏览器，使得用户的所有HTTP请求首先指向Web缓存器。</p>
<h3 id="2-2-6-条件GЕТ方法"><a href="#2-2-6-条件GЕТ方法" class="headerlink" title="2.2.6   条件GЕТ方法"></a>2.2.6   条件GЕТ方法</h3><p>参照《HTTP权威指南》。</p>
<h2 id="2-3-电子邮件"><a href="#2-3-电子邮件" class="headerlink" title="2.3  电子邮件"></a>2.3  电子邮件</h2><p>电子邮件系统有3个主要组成部分：</p>
<ol>
<li><p>用户代理</p>
<p>用户代理允许用户阅读、回复、转发、保存和撰写报文。比如QQ邮箱。邮件代理向其邮件服务器发送和获取邮件。</p>
</li>
<li><p>邮件服务器</p>
<p>每个接收方在其中的某个邮件服务器上有一个邮箱，管理和维护发送的报文。</p>
</li>
<li><p>简单邮件传输协议（SMTP）。</p>
<p>SMTP是电子邮件中主要的应用层协议，使用TCP可靠数据传输服务，从发送方的邮件服务器向接收方的邮件服务器发送邮件。每台邮件服务器上既运行SMTP的客户端也运行SMTP的服务器端。</p>
</li>
</ol>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://i.loli.net/2021/05/13/PSsoeu3xQLARtIl.png"
                      alt="image-20210513223105286"
                ></p>
<h3 id="2-3-2-与HTTP的对比"><a href="#2-3-2-与HTTP的对比" class="headerlink" title="2.3.2 与HTTP的对比"></a>2.3.2 与HTTP的对比</h3><ol>
<li>HTTP主要是一个<strong>拉协议</strong>，用户使用HTTP从该服务器拉取这些应用层信息。SMTP基本上是一个<strong>推协议</strong>，即发送邮件服务器把文件推向接收邮件服务器。</li>
<li>SMTP要求每个报文采用7比特ASCI码格式。如果某报文包含了非7比特ASCI字符或二进制数据，则该报文必须按照7比特ASCI码进行编码。HTTP数据则不受这种限制。</li>
<li>如何处理一个既包含文本又包含图形（也可能是其他媒体类型）的文档。HTTP把每个对象封装到它自己的HTTP响应报文中，而SMTP则把所有报文对象放在一个报文之中。</li>
</ol>
<h2 id="2-4-DNS：因特网的目录服务"><a href="#2-4-DNS：因特网的目录服务" class="headerlink" title="2.4   DNS：因特网的目录服务"></a>2.4   DNS：因特网的目录服务</h2><p>DNS协议是应用层协议，其原因在于：1. 使用c/s模式运行在通信的端系统之间；2. 在通信的端系统之间通过下面的端到端运输协议来传送DNS报文。不同之处在于，DNS是为用户应用程序以及其他软件提供将主机名转换为其背后的IP地址的功能。</p>
<h3 id="2-4-1-DNS提供的服务"><a href="#2-4-1-DNS提供的服务" class="headerlink" title="2.4.1   DNS提供的服务"></a>2.4.1   DNS提供的服务</h3><p>DNS是：1. 由分层的DNS服务器实现的分布式数据库；2.使主机能够查询分布式数据库的应用层协议。DNS服务器通常是运行BIND软件的UNIX机器。DNS还提供了一些重要的服务：</p>
<ol>
<li><p>主机别名</p>
<p>有着复杂主机名的主机能拥有一个或者多个别名。应用程序可以调用DNS来获得主机别名对应的规范主机名以及主机的IP地址。</p>
</li>
<li><p>邮件服务器别名</p>
<p>电子邮件应用程序可以调用DNS，对提供的主机名别名进行解析，以获得该主机的规范主机名及其IP地址。</p>
</li>
<li><p>负载分配</p>
<p>DNS数据库中存储与同一个规范主机名相联系的IP地址集合，当客户对映射到某地址集合的名字发出一个DNS请求时，该服务器用IP地址的整个集合进行响应，但在每个回答中循环这些地址次序，所以DNS就在所有这些冗余的Web服务器之间循环分配了负载。</p>
</li>
</ol>
<h3 id="2-4-2-DNS工作机理概述"><a href="#2-4-2-DNS工作机理概述" class="headerlink" title="2.4.2   DNS工作机理概述"></a>2.4.2   DNS工作机理概述</h3><p>DNS工作过程的总体概括：</p>
<ol>
<li>当主机上的应用程序需要将主机名转换为IP地址时，调用主机上的DNS的客户端，指明需要被转换的主机名</li>
<li>DNS客户端接收后向DNS服务器发送DNS查询报文，DNS请求和回答报文使用UDP数据报经端口53发送</li>
<li>DNS客户端接收到包含IP地址的DNS回答报文，然后传递到调用DNS的应用程序</li>
</ol>
<h4 id="2-4-2-1-分布式、层次数据库"><a href="#2-4-2-1-分布式、层次数据库" class="headerlink" title="2.4.2.1   分布式、层次数据库"></a>2.4.2.1   分布式、层次数据库</h4><p>DNS服务器层次方式组织，有3种类型的DNS服务器：</p>
<ul>
<li>根DNS服务器，提供TLD服务器的IP地址。</li>
<li>顶级域DNS服务器（TLD服务器），提供了权威DNS服务器的IP地址。</li>
<li>权威DNS服务器，具有公共可访问主机（如Web服务器和邮件服务器）的每个组织机构必须提供公共可访问的DNS记录，组织机构自己的或服务提供商的权威DNS服务器收藏这些DNS记录。<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://i.loli.net/2021/05/18/kqsQnGf149gHYpx.png"
                      alt="image-20210518193538282"
                ></li>
</ul>
<p>还有另一类重要的DNS服务器，本地DNS服务器。主机的本地DNS服务器通常“邻近”主机，它起着代理的作用，并将该请求转发到DNS服务器层次结构中。但实际上比下图更复杂，通常TLD服务器只是知道中间的某个DNS服务器，该中间DNS服务器依次才能知道用于该主机的权威DNS服务器。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://i.loli.net/2021/05/18/3QZbqu7FHMi9NdA.png"
                      alt="image-20210518202037321"
                ></p>
<p>上图利用了<strong>递归查询</strong>和<strong>迭代查询</strong>。从理论上讲，任何DNS查询既可以是迭代的也能是递归的。但实践中查询通常遵循的模式是：从请求主机到本地DNS服务器的查询是递归的，其余的查询是迭代的。</p>
<h4 id="2-4-2-2-DNS缓存"><a href="#2-4-2-2-DNS缓存" class="headerlink" title="2.4.2.2   DNS缓存"></a>2.4.2.2   DNS缓存</h4><p>为了改善时延性能并减少DNS报文数量，DNS广泛使用了缓存技术。当某DNS服务器接收一个DNS回答时，它能将映射缓存在本地存储器中，因此本地DNS服务器也能够缓存TLD服务器的IP地址，从而允许本地DNS绕过根DNS服务器。但由于主机和主机名与IP地址间的映射并不永久，DNS服务器在一段时间后（通常设置为两天）将丢弃缓存的信息。</p>
<h3 id="2-4-3-DNS记录和报文"><a href="#2-4-3-DNS记录和报文" class="headerlink" title="2.4.3   DNS记录和报文"></a>2.4.3   DNS记录和报文</h3><p>共同实现DNS分布式数据库的所有DNS服务器存储了资源记录（RR），RR提供了主机名到IP地址的映射。<br>资源记录是一个包含了下列字段的4元组：（Name，Value，Tурe，TTL）</p>
<p>TTL是该记录的生存时间，它决定了资源记录应当从缓存中删除的时间。Name和Value的值取决于Type：</p>
<ul>
<li>如果Type =A，则Name是主机名，Value是该主机名对应的IP地址。一条类型为A的资源记录提供了标准的主机名到IP地址的映射。</li>
<li>如果Type =NS，则Name是个域，Value是知道如何获得该域中主机IP地址的权威DNS服务器的主机名。这个记录用于沿着查询链来路由DNS查询。</li>
<li>如果Type = CNAME，则Value是别名为Name的主机对应的规范主机名。该记录能够向查询的主机提供一个主机名对应的规范主机名。</li>
<li>如果Type =MX，则Value是个别名为Name的邮件服务器的规范主机名。</li>
</ul>
<h2 id="2-5-内容分发网络"><a href="#2-5-内容分发网络" class="headerlink" title="2.5   内容分发网络"></a>2.5   内容分发网络</h2><p>CDN管理分布在多个地理位置上的服务器，在服务器中存储内容的副本，并且所有试图将每个用户请求定向到一个将提供最好的用户体验的CDN位置。CDN可以是专用CDN，即由内容提供商自己所拥有。另一种是第三方CDN。</p>
<p>CDN通常采用两种不同的服务器安置原则</p>
<ul>
<li>深入。该原则是通过在接入ISP中部署服务器集群来深入到ISP的接入网中。其目标是靠近端用户，通过减少端用户和CDN集群之间链路和路由器的数量，从而改善了用户感受的时延和吞吐量。</li>
<li>邀请做客。该原则是通过在少量关键位置（通常是IXP）建造大集群来邀请到ISP做客。与深人设计原则相比，邀请做客设计通常产生较低的维护和管理开销，但可能以对端用户的较高时延和较低吞吐量为代价。</li>
</ul>
<p>一旦CDN的集群准备就绪，它就可以跨集群复制内容。如果客户向一个未存储该内容的集群请求，则该集群检索该内容，向客户流式传输内容的同时在本地存储一个副本。类似于因特网缓存，也会删除不经常请求的内容。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://i.loli.net/2021/05/18/lSiuCAEzgyfxajH.png"
                      alt="image-20210518214333982"
                ></p>

        </div>

        
            <div class="post-copyright-info">
                <div class="article-copyright-info-container">
    <ul>
        <li>本文标题：02-应用层</li>
        <li>本文作者：胡倚豪</li>
        <li>创建时间：2021-05-10 10:36:52</li>
        <li>
            本文链接：huonenumber.github.io/2021/05/10/note/Computer Networking/02-应用层/
        </li>
        <li>
            版权声明：本博客所有文章除特别声明外，均采用 <a class="license" target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">BY-NC-SA</a> 许可协议。转载请注明出处！
        </li>
    </ul>
</div>

            </div>
        

        
            <div class="article-nav">
                
                
                    <div class="article-next">
                        <a class="next"
                           rel="next"
                           href="/2021/05/09/note/Computer%20Networking/01-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%92%8C%E5%9B%A0%E7%89%B9%E7%BD%91/"
                        >
                            <span class="title flex-center">
                                <span class="post-nav-title-item">01-计算机网络和因特网</span>
                                <span class="post-nav-item">下一篇</span>
                            </span>
                            <span class="right arrow-icon flex-center">
                              <i class="fas fa-chevron-right"></i>
                            </span>
                        </a>
                    </div>
                
            </div>
        

        
            <div class="comment-container">
                <div class="comments-container">
    <div id="comment-anchor"></div>
    <div class="comment-area-title">
        <i class="fas fa-comments">&nbsp;评论</i>
    </div>
    

        
            
    <div class="valine-container">
        <script data-pjax
                src="//cdn.jsdelivr.net/npm/valine@latest/dist/Valine.min.js"></script>
        <div id="vcomments"></div>
        <script data-pjax>
            function loadValine() {
                new Valine({
                    el: '#vcomments',
                    appId: 'oRtabIpmHUsCjAVoocAuRiR6-gzGzoHsz',
                    appKey: '8MQB6tSReJAP6eYmI5OGVpTo',
                    meta: ['nick', 'mail', 'link'],
                    avatar: 'wavatar',
                    enableQQ: true,
                    placeholder: '请尽情吐槽吧~',
                    lang: 'zh-CN'.toLowerCase()
                });

                function getAuthor(language) {
                    switch (language) {
                        case 'en':
                            return 'Author';
                        case 'zh-CN':
                            return '博主';
                        default:
                            return 'Master';
                    }
                }

                // Add "Author" identify
                const getValineDomTimer = setInterval(() => {
                    const vcards = document.querySelectorAll('#vcomments .vcards .vcard');
                    if (vcards.length > 0) {
                        let author = '胡倚豪';

                        if (author) {
                            for (let vcard of vcards) {
                                const vnick_dom = vcard.querySelector('.vhead .vnick');
                                const vnick = vnick_dom.innerHTML;
                                if (vnick === author) {
                                    vnick_dom.innerHTML = `${vnick} <span class="author">${getAuthor(KEEP.hexo_config.language)}</span>`
                                }
                            }
                        }
                        clearInterval(getValineDomTimer);
                    } else {
                        clearInterval(getValineDomTimer);
                    }
                }, 2000);
            }

            if ('true') {
                const loadValineTimeout = setTimeout(() => {
                    loadValine();
                    clearTimeout(loadValineTimeout);
                }, 1000);
            } else {
                window.addEventListener('DOMContentLoaded', loadValine);
            }
        </script>
    </div>



        
    
</div>

            </div>
        
    </div>
</div>


                
            </div>

        </div>

        <div class="page-main-content-bottom">
            <footer class="footer">
    <div class="info-container">
        <div class="copyright-info info-item">
            &copy;
            
              <span>2020</span>&nbsp;-&nbsp;
            
            2021&nbsp;<i class="fas fa-heart icon-animate"></i>&nbsp;<a href="/">胡倚豪</a>
        </div>
        
            <script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
            <div class="website-count info-item">
                
                    <span id="busuanzi_container_site_uv">
                        访问人数&nbsp;<span id="busuanzi_value_site_uv"></span>&ensp;
                    </span>
                
                
                    <span id="busuanzi_container_site_pv">
                        总访问量&nbsp;<span id="busuanzi_value_site_pv"></span>
                    </span>
                
            </div>
        
        <div class="theme-info info-item">
            由 <a target="_blank" href="https://hexo.io">Hexo</a> 驱动&nbsp;|&nbsp;主题&nbsp;<a class="theme-version" target="_blank" href="https://github.com/XPoet/hexo-theme-keep">Keep v3.4.3</a>
        </div>
        
    </div>
</footer>

        </div>
    </div>

    
        <div class="post-tools">
            <div class="post-tools-container">
    <ul class="tools-list">
        <!-- TOC aside toggle -->
        
            <li class="tools-item page-aside-toggle">
                <i class="fas fa-outdent"></i>
            </li>
        

        <!-- go comment -->
        
            <li class="go-comment">
                <i class="fas fa-comment"></i>
            </li>
        
    </ul>
</div>

        </div>
    

    <div class="right-bottom-side-tools">
        <div class="side-tools-container">
    <ul class="side-tools-list">
        <li class="tools-item tool-font-adjust-plus flex-center">
            <i class="fas fa-search-plus"></i>
        </li>

        <li class="tools-item tool-font-adjust-minus flex-center">
            <i class="fas fa-search-minus"></i>
        </li>

        <li class="tools-item tool-expand-width flex-center">
            <i class="fas fa-arrows-alt-h"></i>
        </li>

        <li class="tools-item tool-dark-light-toggle flex-center">
            <i class="fas fa-moon"></i>
        </li>

        <!-- rss -->
        
            <li class="tools-item rss flex-center">
                <a class="flex-center"
                   href="/atom.xml"
                   target="_blank"
                >
                    <i class="fas fa-rss"></i>
                </a>
            </li>
        

        

        <li class="tools-item tool-scroll-to-bottom flex-center">
            <i class="fas fa-arrow-down"></i>
        </li>
    </ul>

    <ul class="exposed-tools-list">
        <li class="tools-item tool-toggle-show flex-center">
            <i class="fas fa-cog fa-spin"></i>
        </li>
        
            <li class="tools-item tool-scroll-to-top flex-center">
                <i class="arrow-up fas fa-arrow-up"></i>
                <span class="percent"></span>
            </li>
        
    </ul>
</div>

    </div>

    
        <aside class="page-aside">
            <div class="post-toc-wrap">
    <div class="post-toc">
        <ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#2-1-%E5%BA%94%E7%94%A8%E5%B1%82%E5%8D%8F%E8%AE%AE%E5%8E%9F%E7%90%86"><span class="nav-text">2.1   应用层协议原理</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1-1-%E7%BD%91%E7%BB%9C%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84"><span class="nav-text">2.1.1   网络应用程序体系结构</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1-2-%E8%BF%9B%E7%A8%8B%E9%80%9A%E4%BF%A1"><span class="nav-text">2.1.2   进程通信</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-1-2-1-%E5%AE%A2%E6%88%B7%E5%92%8C%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%BF%9B%E7%A8%8B"><span class="nav-text">2.1.2.1   客户和服务器进程</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-1-2-2-%E8%BF%9B%E7%A8%8B%E4%B8%8E%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E4%B9%8B%E9%97%B4%E7%9A%84%E6%8E%A5%E5%8F%A3"><span class="nav-text">2.1.2.2   进程与计算机网络之间的接口</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-1-2-3-%E8%BF%9B%E7%A8%8B%E5%AF%BB%E5%9D%80"><span class="nav-text">2.1.2.3   进程寻址</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1-3-%E5%8F%AF%E4%BE%9B%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E4%BD%BF%E7%94%A8%E7%9A%84%E8%BF%90%E8%BE%93%E6%9C%8D%E5%8A%A1"><span class="nav-text">2.1.3   可供应用程序使用的运输服务</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1-4-%E5%9B%A0%E7%89%B9%E7%BD%91%E6%8F%90%E4%BE%9B%E7%9A%84%E8%BF%90%E8%BE%93%E6%9C%8D%E5%8A%A1"><span class="nav-text">2.1.4   因特网提供的运输服务</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-1-4-1-TCP-%E6%9C%8D%E5%8A%A1"><span class="nav-text">2.1.4.1   TCP 服务</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-1-4-2-UDP%E6%9C%8D%E5%8A%A1"><span class="nav-text">2.1.4.2   UDP服务</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-1-4-3-TCP%E5%AE%89%E5%85%A8"><span class="nav-text">2.1.4.3  TCP安全</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1-5-%E5%BA%94%E7%94%A8%E5%B1%82%E5%8D%8F%E8%AE%AE"><span class="nav-text">2.1.5   应用层协议</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-2-Web%E5%92%8CHTTP"><span class="nav-text">2.2   Web和HTTP</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-1-HTTP%E6%A6%82%E5%86%B5"><span class="nav-text">2.2.1   HTTP概况</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-2-%E9%9D%9E%E6%8C%81%E7%BB%AD%E8%BF%9E%E6%8E%A5%E5%92%8C%E6%8C%81%E7%BB%AD%E8%BF%9E%E6%8E%A5"><span class="nav-text">2.2.2   非持续连接和持续连接</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-3-HTTP%E6%8A%A5%E6%96%87%E6%A0%BC%E5%BC%8F"><span class="nav-text">2.2.3   HTTP报文格式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-4-%E7%94%A8%E6%88%B7%E4%B8%8E%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%9A%84%E4%BA%A4%E4%BA%92%EF%BC%9Acookie"><span class="nav-text">2.2.4   用户与服务器的交互：cookie</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-5-Web%E7%BC%93%E5%AD%98"><span class="nav-text">2.2.5   Web缓存</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-6-%E6%9D%A1%E4%BB%B6G%D0%95%D0%A2%E6%96%B9%E6%B3%95"><span class="nav-text">2.2.6   条件GЕТ方法</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-3-%E7%94%B5%E5%AD%90%E9%82%AE%E4%BB%B6"><span class="nav-text">2.3  电子邮件</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-3-2-%E4%B8%8EHTTP%E7%9A%84%E5%AF%B9%E6%AF%94"><span class="nav-text">2.3.2 与HTTP的对比</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-4-DNS%EF%BC%9A%E5%9B%A0%E7%89%B9%E7%BD%91%E7%9A%84%E7%9B%AE%E5%BD%95%E6%9C%8D%E5%8A%A1"><span class="nav-text">2.4   DNS：因特网的目录服务</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-4-1-DNS%E6%8F%90%E4%BE%9B%E7%9A%84%E6%9C%8D%E5%8A%A1"><span class="nav-text">2.4.1   DNS提供的服务</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-4-2-DNS%E5%B7%A5%E4%BD%9C%E6%9C%BA%E7%90%86%E6%A6%82%E8%BF%B0"><span class="nav-text">2.4.2   DNS工作机理概述</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-4-2-1-%E5%88%86%E5%B8%83%E5%BC%8F%E3%80%81%E5%B1%82%E6%AC%A1%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="nav-text">2.4.2.1   分布式、层次数据库</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-4-2-2-DNS%E7%BC%93%E5%AD%98"><span class="nav-text">2.4.2.2   DNS缓存</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-4-3-DNS%E8%AE%B0%E5%BD%95%E5%92%8C%E6%8A%A5%E6%96%87"><span class="nav-text">2.4.3   DNS记录和报文</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-5-%E5%86%85%E5%AE%B9%E5%88%86%E5%8F%91%E7%BD%91%E7%BB%9C"><span class="nav-text">2.5   内容分发网络</span></a></li></ol>
    </div>
</div>
        </aside>
    

    <div class="image-viewer-container">
    <img src="">
</div>


    
        <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
          <span class="search-input-field-pre">
            <i class="fas fa-keyboard"></i>
          </span>
            <div class="search-input-container">
                <input autocomplete="off"
                       autocorrect="off"
                       autocapitalize="off"
                       placeholder="搜索..."
                       spellcheck="false"
                       type="search"
                       class="search-input"
                >
            </div>
            <span class="popup-btn-close">
                <i class="fas fa-times"></i>
            </span>
        </div>
        <div id="search-result">
            <div id="no-result">
                <i class="fas fa-spinner fa-pulse fa-5x fa-fw"></i>
            </div>
        </div>
    </div>
</div>

    

</main>



<script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.3/source/js/utils.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.3/source/js/main.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.3/source/js/header-shrink.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.3/source/js/back2top.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.3/source/js/dark-light-toggle.js"></script>


    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.3/source/js/local-search.js"></script>



    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.3/source/js/code-copy.js"></script>



    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.3/source/js/lazyload.js"></script>


<div class="post-scripts pjax">
    
        <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.3/source/js/left-side-toggle.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.3/source/js/libs/anime.min.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.3/source/js/toc.js"></script>
    
</div>


    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.3/source/js/libs/pjax.min.js"></script>
<script>
    window.addEventListener('DOMContentLoaded', () => {
        window.pjax = new Pjax({
            selectors: [
                'head title',
                '.page-container',
                '.pjax'
            ],
            history: true,
            debug: false,
            cacheBust: false,
            timeout: 0,
            analytics: false,
            currentUrlFullReload: false,
            scrollRestoration: false,
            // scrollTo: true,
        });

        document.addEventListener('pjax:send', () => {
            KEEP.utils.pjaxProgressBarStart();
        });

        document.addEventListener('pjax:complete', () => {
            KEEP.utils.pjaxProgressBarEnd();
            window.pjax.executeScripts(document.querySelectorAll('script[data-pjax], .pjax script'));
            KEEP.refresh();
        });
    });
</script>



</body>
</html>
